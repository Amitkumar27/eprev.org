(function(){'use strict';function a(K,L){let M=!1;return function(...O){M||(M=!0,requestAnimationFrame(()=>{K.apply(L,O),M=!1}))}}function b(K,L=50,M){let N;return function(...P){N&&clearTimeout(N),N=setTimeout(()=>{N=void 0,K.apply(M,P)},L)}}function d(K){function L(){return void 0!==ba}function M(ea){!ca&&D(ea.deltaX)>D(ea.deltaY)&&(ea.preventDefault(),$=T(ea.deltaX))}function N(ea){if(!ca){ca=!0;const fa=ea.clientX;let ha=$;const ia=ka=>{ha=T(ka.clientX-fa)},ja=()=>{ba.classList.remove('scrollbar--active'),$=ha,document.removeEventListener('mousemove',ia),document.removeEventListener('mouseup',ja),ca=!1};ba.classList.add('scrollbar--active'),document.addEventListener('mousemove',ia),document.addEventListener('mouseup',ja)}}function O(){if(!ca){ca=!0;const fa=window.pageXOffset+K.getBoundingClientRect().left,ha=fa+.9*X,ia=fa+.1*X;let ja=$;const ka=ma=>{ma.clientX>ha?ja=T(Y):ma.clientX<ia&&(ja=T(-Y))},la=()=>{$=ja,document.removeEventListener('mousemove',ka),document.removeEventListener('mouseup',la),ca=!1};document.addEventListener('mousemove',ka),document.addEventListener('mouseup',la)}}function P(ea){if(!(ca||1<ea.touches.length)){ca=!0;const fa=ea.touches[0].clientX,ha=ea.touches[0].clientY;let ia=$,ja=!1,ka=!1;const la=na=>{if(!(1<na.touches.length)){const oa=na.touches[0].clientX-fa;if(!ja){const pa=na.touches[0].clientY-ha;D(oa)>D(pa)&&(ka=!0),ja=!0}ka&&(ia=T(-oa))}},ma=()=>{ca=!1,$=ia,document.removeEventListener('touchmove',la),document.removeEventListener('touchen',ma),document.removeEventListener('touchcancel',ma)};document.addEventListener('touchmove',la),document.addEventListener('touchend',ma),document.addEventListener('touchcancel',ma)}}function Q(){ba=document.createElement('div'),ba.classList.add('scrollbar'),ba.classList.add('scrollbar--horizontal'),K.style.touchAction='pan-y',R(),K.appendChild(ba),K.addEventListener('wheel',M),K.addEventListener('touchstart',P),K.addEventListener('mousedown',O),ba.addEventListener('mousedown',N)}function R(){const ea=C(E(X*X/Y),F);aa=(Y-X)/(X-ea),_=X-ea,ba.style.width=ea+'px',[ba,...Z].forEach(fa=>fa.style.willChange='transform')}function S(){K.removeEventListener('wheel',M),K.removeEventListener('touchstart',P),K.removeEventListener('mousedown',O),ba.removeEventListener('mousedown',N),K.removeChild(ba),ba=void 0,V()}function T(ea){const fa=0<ea?B($+ea,_):C($+ea,0);return ba.style.transform=`translateX(${fa}px)`,U(-1*fa*aa),fa}function U(ea){Z.forEach(fa=>{fa.style.transform=`translateX(${ea}px)`})}function V(){ba&&(ba.style.transform=`translateX(0)`),U(0),$=0,ca=!1}function W(){const ea=getComputedStyle(K);X=K.clientWidth-parseFloat(ea.getPropertyValue('padding-left'))-parseFloat(ea.getPropertyValue('padding-right')),Z=Array.from(K.childNodes).filter(fa=>{return fa!==ba}),Y=Z.reduce((fa,ha)=>{return C(ha.scrollWidth,fa)},0),Y>X?(L()?R():Q(),V()):L()&&S()}if(G.has(K))return G.get(K);let X,Y,Z,$,_,aa,ba,ca;W();const da={update:W};return G.set(K,da),da}function f(){H||(H=!0,I=window.innerWidth,window.addEventListener('resize',J))}function g(){H=!1,window.removeEventListener('resize',J)}const{PI:i,abs:j,min:k,sin:l,cos:m,atan:p}=Math,q=(()=>{const K=document.createElementNS('http://www.w3.org/2000/svg','svg');K.setAttribute('viewBox','0 0 2 2'),Object.assign(K.style,{position:'absolute',top:0,left:0,width:'2px',height:'2px'}),K.innerHTML='<rect width="1" height="1" style="transform: translate(1px, 1px)"/>',document.body.appendChild(K);const L=document.elementFromPoint(1,1)!==K;return K.parentNode.removeChild(K),L})(),s=24,z=function(K,...L){return L[1===K?0:1]},A=document.querySelector('[data-issue-id]');if(A){const K=A.dataset.issueId;fetch(`https://api.github.com/repos/eprev/eprev.org/issues/${K}`,{headers:new Headers({Accept:'application/vnd.github.v3.text+json'})}).then(L=>{200===L.status&&L.json().then(M=>{const N=M.comments;if(N){const O=`There ${z(N,'is','are')} <a
                href="https://github.com/eprev/eprev.org/issues/${K}"
                data-ga-on="click"
                data-ga-category="Click"
                data-ga-action="Comments"
                data-ga-label="${location.pathname}"
              >${N} ${z(N,'comment','comments')}</a> on this (visit the post’s issue page on GitHub).`;A.querySelector('.post-comments__text').innerHTML=O}})})}const{min:B,max:C,abs:D,floor:E}=Math,F=50,G=new WeakMap;let H=!1,I;const J=a(()=>{if(I!==window.innerWidth){I=window.innerWidth;const K=Array.from(document.querySelectorAll('.scrollable--enabled'));K.forEach(L=>{const M=G.get(L);M&&M.update()}),0===K.length&&g()}});if(window.Worker){function K(){document.querySelector('.page__content').classList.add('search-hidden'),T.classList.remove('search-hidden')}function L(){document.querySelectorAll('.search-hidden').forEach(V=>V.classList.remove('search-hidden')),T.classList.add('search-hidden')}function M(V){V?(K(),O&&(P=V,N.postMessage({type:'search',query:V}))):L()}document.querySelectorAll('.search-control').forEach(V=>V.disabled=!1);const N=new Worker(document.querySelector('[data-search-worker-href]').dataset.searchWorkerHref);N.addEventListener('error',V=>{ga('send','event','JavaScript Error',V.message,V.filename?V.filename+':'+V.lineno:'N/A',{nonInteraction:1})});let O=!1,P,Q='-',R=b((V,W)=>{1<V.length&&ga('send','event','Search',V,W)},500);N.addEventListener('message',V=>{const{type:W}=V.data;if('ready'===W||'updated'===W)O=!0,M(S.value);else if('error'===W)U.innerHTML='<p><em>Sorry! Something went wrong\u2026</em></p>';else if('results'===W){const X=V.data.results,Y=X.map(Z=>Z.url).toString();R(P,X.length),Y!==Q&&(Q=Y,U.innerHTML=X.length?`<ol class="search-results__list">${X.map(Z=>`<li class="search-results__item"><a
                  href="${Z.url}"
                  data-ga-on="click"
                  data-ga-category="Click"
                  data-ga-action="Search Results"
                  data-ga-label="${Z.url}"
                >${Z.title}</a> <span>${Z.date}</span></li>`).join('')}</ol>`:`<p><em>Nothing yet. Keep typing…</em></p>`)}});const S=document.querySelector('.search-input');S.addEventListener('focus',()=>N.postMessage({type:'init'}),{once:!0});const T=document.createElement('div');T.className='page__content search-results search-hidden',document.querySelector('.page').appendChild(T),T.innerHTML=`<h1 class="search-results__header">Search results</h1><div class="search-results__content"><p><em>Loading…</em></div>`;const U=T.querySelector('.search-results__content');document.querySelector('.search-toggle').addEventListener('click',()=>{S.classList.contains('search-input--visible')?(L(),S.classList.remove('search-input--visible')):(S.classList.add('search-input--visible'),S.value='',S.focus())}),S.addEventListener('input',V=>M(V.target.value))}(function(K){function L(){const _=window.innerHeight,{top:aa,bottom:ba,height:ca}=K.getBoundingClientRect();0<=aa&&aa<_||0<ba&&ba<=_||ca>_&&0>aa&&ba>_?M():N()}function M(){T.forEach(_=>{const{left:aa,top:ba,width:ca,height:da}=_.el.getBoundingClientRect();_.left=aa+window.pageXOffset+ca/2,_.top=ba+window.pageYOffset+da/2}),document.addEventListener('mousemove',Y),document.addEventListener('touchstart',Z),document.addEventListener('touchend',$),document.addEventListener('touchcancel',$)}function N(){S(),document.removeEventListener('mousemove',Y),document.removeEventListener('touchstart',Z),document.removeEventListener('touchend',$),document.removeEventListener('touchcancel',$)}function O(_,aa,ba){q?_.style.transform=`translate(${aa}px, ${ba}px)`:_.setAttribute('transform',`translate(${aa} ${ba})`)}function P(_,aa=1,ba=1,ca=0,da=0){const ea=`matrix(${aa}, 0, 0, ${ba}, ${ca*(1-aa)}, ${da*(1-ba)})`;q?U.style.transform=ea:U.setAttribute('transform',ea)}function Q(_,aa,ba){const ca=aa?0>aa?i+p(ba/aa):p(ba/aa):0,da=k(s,j(aa))*m(ca),ea=-1*(k(s,j(ba))*l(ca));O(_,da,ea)}function R(_=250){W||(W=!0,clearTimeout(V),V=setTimeout(()=>P(U,0.25,1.5,208,436),_))}function S(_=125){W&&(W=!1,clearTimeout(V),V=setTimeout(()=>P(U),_))}const T=[{el:K.querySelector('[data-id=right-eye]')},{el:K.querySelector('[data-id=left-eye]')}],U=K.querySelector('[data-id=mouth]');q&&(T.forEach(_=>_.el.style.willChange='transform'),Object.assign(U.style,{willChange:'transform',transitionDuration:'.25s',transitionProperty:'transform'}));let V=null,W=!1;const X=a(()=>{L()}),Y=a(_=>{T.forEach(aa=>{Q(aa.el,_.pageX-aa.left,aa.top-_.pageY)}),_.target.closest('a')?R():S()}),Z=a(_=>{const aa=_.touches.item(0);T.forEach(ba=>{Q(ba.el,aa.pageX-ba.left,ba.top-aa.pageY)}),R(0)}),$=a(()=>{S(0)});return window.addEventListener('scroll',X,{passive:!0}),window.addEventListener('resize',X),L(),{resume:M,pause:N}})(document.querySelector('.page__user-picture')),function(K=document){const L=Array.from(K.querySelectorAll('.scrollable:not(.scrollable--enabled)'));L.forEach(M=>{M.classList.add('scrollable--enabled'),d(M)}),L.length&&f()}()})();